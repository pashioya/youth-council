<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <thymeleaf
            th:replace="fragments/meta :: meta_script_link('Ideas')"></thymeleaf>
    <script defer th:src="@{/js/sidebar.js}"></script>
    <link rel="stylesheet" th:href="@{/css/global.css}"/>
    <link rel="stylesheet" th:href="@{/css/ideas.css}"/>
    <script defer th:src="@{/js/forms/add_comment.js}"></script>
    <script defer th:src="@{/js/forms/add_idea.js}"></script>
    <script defer th:src="@{/js/entities/interact_with_entity.js}"></script>
</head>
<body class="bg-light">
<div th:include="fragments/header :: header"></div>
<div th:include="fragments/sidebar :: sidebar(ycId=1)"></div>
<div class="height-100 bg-light pt-4 mt-5">
    <main class="container h-100">
        <div
                class="col mb-2 d-flex flex-column align-items-center h-100"
        >
            <div class="col-md-6" id="ideas">

                <!--                thymeleaf ideas-->
                <div
                        class="col g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative"
                        th:each="idea : ${ideas}"
                >
                    <div
                            class="col p-4 d-flex flex-column position-static"
                    >
                        <!--                            images-->
                        <div class="col-auto d-none d-lg-block">
                            <div
                                    class="carousel slide"
                                    data-bs-ride="carousel"
                                    th:attr="id='myCarousel' + ${idea.getId()}"
                            >
                                <div class="carousel-indicators" th:if="${idea.getImages().size() >1}">
                                    <button th:aria-current="${iterstat.index}== 0"
                                            th:aria-label="'Slide ' + ${iterstat.index + 1}"
                                            th:attr="data-bs-target='#myCarousel' + ${idea.getId()}"
                                            th:class="${iterstat.index}== 0  ? 'active':''"
                                            th:data-bs-slide-to="${iterstat.index}"
                                            th:each="image, iterstat : ${idea.getImages()}"
                                            type="button"
                                    ></button>
                                </div>
                                <div class="carousel-inner">
                                    <div th:class="${iterstat.index}== 0  ? 'carousel-item active':'carousel-item'"
                                         th:each="image, iterstat : ${idea.getImages()}">
                                        <img
                                                th:src="'data:image/jpeg;base64,' + ${image}"
                                        />
                                    </div>
                                </div>
                                <button
                                        class="carousel-control-prev"
                                        data-bs-slide="prev"
                                        th:attr="data-bs-target='#myCarousel' + ${idea.getId()}"
                                        th:if="${idea.getImages().size() >1}"
                                        type="button"
                                >
                                            <span
                                                    aria-hidden="true"
                                                    class="carousel-control-prev-icon"
                                            ></span>
                                    <span class="visually-hidden"
                                    >Previous</span
                                    >
                                </button>
                                <button
                                        class="carousel-control-next"
                                        data-bs-slide="next"
                                        th:attr="data-bs-target='#myCarousel' + ${idea.getId()}"
                                        th:if="${idea.getImages().size() >1}"
                                        type="button"
                                >
                                            <span
                                                    aria-hidden="true"
                                                    class="carousel-control-next-icon"
                                            ></span>
                                    <span class="visually-hidden"
                                    >Next</span
                                    >
                                </button>
                            </div>
                        </div>
                        <!--                            theme -->
                        <strong class="d-inline-block mb-1 text-primary" th:text="${idea.getTheme()}">Theme</strong>
                        <!-- <h3 class="mb-1">Idea Title</h3> -->
                        <div class="col d-flex gap-2 mb-4">
                            <!--                                author-->
                            <div class="text-muted fs-6" th:text="${idea.getAuthor()}">Author</div>
                            <div class="text-muted fs-6">Â·</div>
                            <!--                                time-->
                            <div class="text-muted fs-6"
                                 th:text="${#temporals.format(idea.getDateAdded(), 'yyyy-MM-dd')}">Date
                                /Time
                            </div>
                        </div>
                        <!--                            description -->
                        <p class="mb-4" th:text="${idea.getDescription()}">
                        </p>
                        <div class="d-flex flex-row gap-3">
                            <!--                                like button-->
                            <div
                                    class="d-flex flex-row align-items-center"
                                    role="button"
                                    th:attr="onclick=|toggleLike(${idea.getId()},'ideas')|"
                                    th:id="|like-container-${idea.getId()}|"
                            >
                                <svg
                                        class="transformable"
                                        height="24"
                                        th:style="|fill: ${idea.isLikedByUser() ? 'red' : 'black'}|"
                                        viewBox="0 0 24 24"
                                        width="24"
                                        xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                            d="M20.205 4.791a5.938 5.938 0 0 0-4.209-1.754A5.906 5.906 0 0 0 12 4.595a5.904 5.904 0 0 0-3.996-1.558 5.942 5.942 0 0 0-4.213 1.758c-2.353 2.363-2.352 6.059.002 8.412L12 21.414l8.207-8.207c2.354-2.353 2.355-6.049-.002-8.416z"
                                    ></path>
                                </svg>
                                <p class="small text-muted mb-0"
                                   th:text="${idea.getNumberOfLikes()}"></p>
                            </div>
                            <!--                                end like button-->
                            <!--                                comment button-->

                            <div
                                    class="d-flex flex-row align-items-center transformable"
                            >
                                <button
                                        aria-expanded="true"
                                        class="btn btn-primary"
                                        data-bs-toggle="collapse"
                                        style="all: unset; cursor: pointer"
                                        th:attr="aria-controls='idea-' + ${idea.getId()} + '-comment-section'"
                                        th:data-bs-target="'#idea-' + ${idea.getId()} + '-comment-section'"
                                        type="button"
                                >
                                    <svg
                                            height="24"
                                            viewBox="0 0 24 24"
                                            width="24"
                                            xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                                d="M20 1.999H4c-1.103 0-2 .897-2 2v18l4-4h14c1.103 0 2-.897 2-2v-12c0-1.103-.897-2-2-2zm-6 11H7v-2h7v2zm3-4H7v-2h10v2z"
                                        ></path>
                                    </svg>
                                </button>
                            </div>

                            <!--                                end comment button-->
                            <!--                                share button -->
                            <div
                                    class="d-flex flex-row align-items-center transformable"
                            >
                                <svg
                                        height="24"
                                        viewBox="0 0 24 24"
                                        width="24"
                                        xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                            d="M5.5 15a3.51 3.51 0 0 0 2.36-.93l6.26 3.58a3.06 3.06 0 0 0-.12.85 3.53 3.53 0 1 0 1.14-2.57l-6.26-3.58a2.74 2.74 0 0 0 .12-.76l6.15-3.52A3.49 3.49 0 1 0 14 5.5a3.35 3.35 0 0 0 .12.85L8.43 9.6A3.5 3.5 0 1 0 5.5 15zm12 2a1.5 1.5 0 1 1-1.5 1.5 1.5 1.5 0 0 1 1.5-1.5zm0-13A1.5 1.5 0 1 1 16 5.5 1.5 1.5 0 0 1 17.5 4zm-12 6A1.5 1.5 0 1 1 4 11.5 1.5 1.5 0 0 1 5.5 10z"
                                    ></path>
                                </svg>
                            </div>
                            <!--                                end share button-->
                        </div>
                        <!--                                comments-->
                        <div
                                class="collapse mt-5"
                                th:attr="id='idea-' + ${idea.getId()} + '-comment-section'"
                        >
                            <!--                            comment submission form-->
                            <form
                                    action="#"
                                    class="form-floating mb-4 bg-light-subtle d-flex comment-form"
                                    th:attr="id='add-comment-idea-' + ${idea.getId()}"
                            >
                                <div class="w-100 mb-3 d-flex">
                                    <span
                                            class="form-control d-block w-100 overflow-hidden textarea"
                                            contenteditable
                                            th:attr="id='add-comment-' + ${idea.getId()}"
                                    >
                                    </span>
                                    <span class="input-group-text" id="basic-addon2">
                                        <button
                                                class="submit-comment"
                                                style="all: unset; cursor: pointer"
                                                type="submit"
                                        >
                                        <svg
                                                class="bi bi-send submit-button"
                                                fill="currentColor"
                                                height="30"
                                                style="height: 30px; width: 30px"
                                                viewBox="0 0 16 16"
                                                width="30"
                                                xmlns="http://www.w3.org/2000/svg"
                                        >
                                        <path
                                                d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"
                                        />
                                        </svg>
                                        </button>
                                    </span>
                                </div>
                            </form>
                            <!--                            comment submission form ends-->
                            <div
                                    class="fs-6 text-secondary bg-light d-flex flex-column gap-3"
                            >
                                <div class="card"
                                     th:attr="id='idea-' + ${idea.getId()} + '-comment-' + ${comment.getId()}"
                                     th:each="comment : ${idea.getComments()}">
                                    <div
                                            class="card-header d-flex justify-content-between"
                                    >
                                        <div
                                                class="d-flex align-items-center gap-3"
                                        >
                                            <svg
                                                    class="bi bi-person-circle d-flex"
                                                    fill="currentColor"
                                                    height="32"
                                                    style="
                                                            width: 42px;
                                                            height: 42px;
                                                        "
                                                    viewBox="0 0 16 16"
                                                    width="32"
                                                    xmlns="http://www.w3.org/2000/svg"
                                            >
                                                <path
                                                        d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"
                                                />
                                                <path
                                                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"
                                                        fill-rule="evenodd"
                                                />
                                            </svg>
                                            <span th:text="${comment.getAuthor()}"></span>
                                        </div>
                                        <div
                                                class="d-flex align-items-center gap-3"
                                        >
                                            <span class="date-time" th:text="${comment.getCreatedDate()}"></span>
                                            <!--                                            comment edit button-->
                                            <a
                                                    class="text-secondary"
                                                    href="#"
                                            >
                                                <svg
                                                        class="bi bi-pencil"
                                                        fill="currentColor"
                                                        height="16"
                                                        viewBox="0 0 16 16"
                                                        width="16"
                                                        xmlns="http://www.w3.org/2000/svg"
                                                >
                                                    <path
                                                            d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"
                                                    />
                                                </svg>
                                            </a>
                                            <!--                                            comment edit button ends-->
                                            <!--                                            comment delete button-->
                                            <button
                                                    class="text-danger"
                                                    data-bs-target="#modal"
                                                    data-bs-toggle="modal"
                                                    style="
                                                            border: none;
                                                            background: none;
                                                        "
                                            >
                                                <svg
                                                        class="bi bi-trash col"
                                                        fill="currentColor"
                                                        height="16"
                                                        viewBox="0 0 16 16"
                                                        width="16"
                                                        xmlns="http://www.w3.org/2000/svg"
                                                >
                                                    <path
                                                            d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"
                                                    />
                                                    <path
                                                            d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"
                                                            fill-rule="evenodd"
                                                    />
                                                </svg>
                                            </button>
                                            <!--                                            comment delete button ends-->
                                        </div>
                                    </div>
                                    <div class="card-body d-flex gap-3">
                                        <span class="comment-content col" th:text="${comment.getContent()}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--                                end comments-->
                    </div>

                </div>
            </div>
        </div>

        <div aria-hidden="true" aria-labelledby="idea-submission-modal-label" class="modal fade" id="idea-submission-modal"
             tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5 text-center" id="idea-submission-modal-label">What's your idea?</h1>
                        <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                    </div>
                    <div class="modal-body">
                        <form id="submitForm">
                            <div class="form-group mb-3">
                                <label for="theme">Theme</label>
                                <select class="form-control" id="theme">
                                    <option th:each="theme : ${themes}" th:text="${theme.name}"
                                            th:value="${theme.id}"></option>
                                </select>
                            </div>
                            <div class="form-group mb-3">
                                <label for="description">Description</label>
                                <textarea class="form-control" id="description"
                                          th:placeholder="'What would make ' + ${municipalityName} + ' a better place to live? Let us know.'"></textarea>
                            </div>
                            <div class="form-group mb-3">
                                <label for="idea-image">Upload up to 4 images</label>
                                <input accept="image/*" class="form-control" id="idea-image" multiple
                                       name="idea-image" type="file">
                            </div>
                            <div class="form-group mt-3 mb-5 d-flex align-items-center justify-content-center">
                                <a class="btn btn-primary " id="submit-idea">Submit your idea</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!--            thymeleaf end-->
        <div class="container sticky-bottom">
            <button
                    class="btn btn-success lg-rounded shadow position-absolute bottom-0 end-0 mb-5 me-5"
                    data-bs-target="#idea-submission-modal" data-bs-toggle="modal"
            >
                <svg
                        fill="none"
                        height="48"
                        stroke="white"
                        stroke-width="1.5"
                        viewBox="0 0 24 24"
                        width="48"
                        xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                            d="M12 4.5v15m7.5-7.5h-15"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                    />
                </svg>
            </button>
        </div>
    </main>
</div>
</body>
</html>
